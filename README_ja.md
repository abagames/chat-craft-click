# AI 支援ワンボタンゲーム開発プラットフォーム CharCraftClick

[English](./README.md) | 日本語

CharCraftClick は、対話型 AI 活用して高品質なワンボタンゲームを簡単に作成・テスト・改良できるプラットフォームである。技術的な知識がなくても、会話を通じて斬新でバランスの取れたゲームを短時間で制作できる。

## プロジェクト概要

このプラットフォームは、ゲーム開発経験の有無に関わらず、誰でも高品質なワンボタンゲームを作成できることを目指している。アイデア生成から自動評価、実装、改良までの全プロセスを対話的に実行できる点が特徴だ。従来のゲーム開発における試行錯誤や主観的評価の課題を解決し、データに基づく客観的な開発アプローチを実現する。

## 特徴

### 1. データ駆動型ゲーム設計と自動評価システム

- 主観的判断に頼らない、定量的指標に基づくゲーム設計アプローチ
- 「スキルギャップ」「単調入力耐性」「難易度進行」などを自動測定
- プレイヤー行動パターンをシミュレーションするテスト環境が客観的評価を実現
- テスト結果に基づくゲーム改善の具体的な指針を提供

### 2. 包括的な設計ガイドと開発フレームワーク

- ワンボタンゲーム特有の設計課題を網羅した体系的なガイドライン
- アイデア創出から実装、テスト、評価までの全工程をサポート
- 相互作用パターン、環境相互作用、動きのパターンなどの分類体系

### 3. 会話型インターフェースによる効率的な創造プロセス

- 対話形式でゲームコンセプトの生成からテスト、実装まで完結
- 複数のゲームアイデアを同時に評価・比較し、最適な選択を支援
- 技術的な知識がなくても、会話を通じて斬新でバランスの取れたゲームを制作可能
- アイデア生成から実装までのプロセスが透明で追跡可能

## 前提条件

- 特別な技術知識は不要である。基本的なゲームの概念を理解していれば十分だ。
- ブラウザ環境（または Claude アプリケーション）があれば、追加のソフトウェアやツールは必要ない。
- プロジェクトの knowledge または添付ファイルにリポジトリ内の`knowledge`のファイルを与える必要がある。
- Claude 3.7 Sonnet の使用が推奨される（より高品質な評価と実装が可能）。
- Claude の「Analysis tool」機能をオンにすること（REPL 環境でのゲームテストに必須）。

## 使い方

### 1. テーマを入力してゲームアイデアを生成

```
テーマは海底探検。日本語で答えて
```

このステップで、システムは設計ガイドラインに基づいた複数のユニークなゲームコンセプトを生成する。各コンセプトは核となるメカニクス、目標、チャレンジ要素、スコアリングシステムを備えている。

> 海底探検をテーマにしたワンボタンゲームの作成をお手伝いします！ガイドラインに沿って、ステップバイステップで開発プロセスを進めていきましょう。
>
> ## アイデア生成フェーズ
>
> まずは海底探検をテーマにした 5 つの異なるワンボタンゲームのコンセプトを生成します。
>
> ### コンセプト 1: 「ディープダイバー」
>
> 1. **コアメカニック**: ボタンを押すとダイバーが上に泳ぎ、離すと重力で沈みます
> 2. **プレイヤーの目標**: 狭い海底洞窟を航行しながら宝物を集める
> 3. **チャレンジ要素**: 時間経過で空気が減少し、洞窟の壁に衝突すると装備にダメージ
> 4. **スコアシステム**: 移動距離に応じたポイントと集めた宝物のボーナスポイント
> 5. **ワンボタンパターン**: 押すと上昇、離すと下降
> 6. **独自の魅力**: 限られた空気供給を管理しながら垂直移動のバランスを取る
> 7. **リスク報酬力学**: 狭い道は危険が高いが価値ある宝物があります
>
> ### コンセプト 2: 「プレッシャーパルス」
>
> 1. **コアメカニック**: ボタン長押しでソナーパルスを蓄積し、離すと全方向に放出
> 2. **プレイヤーの目標**: ソナーパルスを使って隠れた海洋生物を検知・発見する
>
> ..(省略)..

### 2. 自動評価結果を確認し、実装するゲームを選択

システムは各ゲームコンセプトを REPL テスト環境で評価し、以下の指標に基づいて比較結果を提示する：

- ゲームの持続時間
- スキルギャップ（熟練者と初心者のスコア比）
- 難易度の進行
- 単調入力パターン（押しっぱなし、連打など）への耐性

評価結果から、最も可能性の高いゲームを推薦し、承認後に実装する。

> ## コンセプト選択フェーズ
>
> テスト結果に基づくと、「ディープダイバー」が最も優れたコンセプトで、「平均的」という評価と 12 点満点中 4 点を獲得しました。この点数は特に印象的ではないようですが、他のコンセプトよりも大幅に優れています。強みと弱みを分析しましょう：
>
> ### ディープダイバー - 分析
>
> **強み：**
>
> - 優れたスキルギャップ（4.29 倍）- 熟練プレイヤーは大幅に良いパフォーマンスを発揮できます
> - マスターするのにスキルが必要な良い相互作用パターン
>
> **弱み：**
>
> - 短いゲーム持続時間 - ゲームが早く終わりすぎます
> - 不十分な難易度の進行 - ゲームが速すぎる速度で難しくなります
> - 単調な入力パターンに弱い
>
> ### ディープダイバー - テストに基づく改善点
>
> 実装前に、テスト結果の推奨事項に基づいてコンセプトを改善しましょう：
>
> 1. ゲームプレイ時間を延長するために初期難易度を下げる
> 2. 最初の洞窟の通路を広くする
> 3. 空気の減少率を遅くする
> 4. 熟練したプレイのためのスコア獲得機会を増やす
> 5. 単調な入力を罰するメカニズムを追加（ボタンの長押しで乱流が発生するなど）
> 6. ゲームプレイを延長するための空気タンクなどのパワーアップを追加
> 7. 固定速度ではなく、変動する障害物速度を実装
>
> ## 実装フェーズ
>
> p5.js テンプレートを使用して改良されたディープダイバーゲームを実装しましょうか？

```
それを実装して
```

### 3. 実装されたゲームをプレイして対話的に洗練

---

改良されたディープダイバーゲームを p5.js テンプレートを使って実装します。テスト段階で提案されたすべての改善点を含む完全な HTML ファイルを作成します。

---

ブラウザ上でゲームをすぐに遊ぶことができ、プレイ感覚に基づいて会話でフィードバックを提供できる。システムはこれらのフィードバックを具体的な改善に変換し、ゲームを継続的に洗練する。

```
Playerが前進しないように
```

> プレイヤーが自動的に前進しないようにゲームを修正します。代わりに、プレイヤーが水平方向に固定位置にとどまり、洞窟が過ぎ去るようにします：
>
> プレイヤーが前進しないようにゲームを修正しました。変更点は以下の通りです：
>
> 1. プレイヤーは固定された x 位置（水平方向）にとどまります
> 2. 洞窟、宝物、その他の要素がプレイヤーの前を通過します
> 3. プレイヤーはボタンを押すか離すときだけ垂直方向に移動します
> 4. スクロール速度は`player.scrollSpeed`プロパティによって制御されます
> 5. スピードパワーアップはまだ機能しますが、プレイヤーの移動ではなくスクロール速度を上げるようになりました
>
> この変更により、ゲームプレイはクラシックなエンドレスランナーやサイドスクローラーのようになり、キャラクターは水平方向に固定位置にとどまりながら、環境がその周りを移動します。ゲームはまだスクロール距離を追跡しており、宝物の収集、空気の管理、障害物の回避などの他のメカニクスはこれまでと同じように機能します。
>
> これでプレイヤーは洞窟の通路を通り抜けるために垂直方向の移動だけに集中すればよくなり、操作方法がさらにシンプルになり、「ワンボタン」コンセプトにより焦点を当てています。
>
> 他に何か変更をご希望ですか？

シンプルな指示で、ゲームバランスの調整、視覚的変更、メカニクスの変更などを行うことができる。

出来上がったゲームは[ブラウザで遊べる](https://abagames.github.io/ChatCraftClick/sample-deep-diver.html)。

[![deep-diver](./docs/screenshot-deep-diver.gif)](https://abagames.github.io/ChatCraftClick/sample-deep-diver.html)

## Tips & トラブルシューティング

### ゲーム実装時の問題に対処する

- **HTML ファイルが大きすぎる場合**: Claude が Artifact のサイズ制限を超えてゲームを作成しようとした場合、以下を入力すること。
  ```
  777lines
  ```
  これによりコードが最適化され、制限内に収まるようになる。777lines はプロンプト内で指定されている HTML ファイルのライン数制限である。

### 生成されたゲーム案が気に入らない場合

- **新しいコンセプトが欲しい場合**: ゲームコンセプトに対するテスト結果が不満足な場合、以下を入力して新しいアイデアを求めることができる。
  ```
  他のコンセプト
  ```
  システムは異なるアプローチや視点から新たなゲームアイデアを生成する。

### より良いゲーム作成のために

- シンプルな修正指示が効果的である（「ジャンプ力を上げて」「アイテムを取るたびにスコア倍率を 1 上げて」など）
- 複数の小さな変更を一度に求めるより、一つずつ変更して効果を確認するとより良い結果が得られる

## 応用例

このプラットフォームを使用して作成できるゲームの例：

1. **bubble-ascent**：あなたは魚。泡を取ってパワーアップ！岩を壊そう

   - タップで上昇

https://github.com/user-attachments/assets/e180b085-ce42-4254-8339-80a8118d6372

2. **burger-stack**：バーガーの材料をタイミングよく落とそう。横風には注意

   - タップで材料を落とす

https://github.com/user-attachments/assets/03cec4ca-abf0-4758-8e04-f2f2e876ac1d

3. **orbit-jumper**：惑星の軌道を渡り歩こう。動いている惑星を回って燃料回復

   - タップで軌道から飛び出す

https://github.com/user-attachments/assets/6895a186-4643-4cab-91c3-6f29189e300b

4. **lave-surfing**：溶岩の波を乗りこなしてミネラルを集めよう

   - タップでジャンプして上の溶岩へ、押しっぱなしで下の溶岩へ移動できる

https://github.com/user-attachments/assets/5bdd06df-7e5f-44b8-8e13-ee3bc8686d11

これらの例のような BGM や効果音を追加したい場合は、以下の記事が参考になる。

- [生成 AI 時代のミニゲームの作り方 - アイデアとコードと絵と音を生成する](https://aba.hatenablog.com/entry/2025/01/25/183737)

具体的には、ゲーム完成後に以下のプロンプトを用いると良い。

```
このゲームにふさわしいBGMを音楽生成AIで生成するためのプロンプトを作成して
```

```
このゲームに必要な効果音を、名前と効果音生成AIに与えるプロンプトの組でリストアップして
```

BGM を`bgm.mp3`、効果音を`[名前].mp3`で生成し、`audios`ファイル内に配置する。上記ゲームの`main.js`を参考例として添付し、以下のプロンプトで音声ファイル再生ロジックを追加する。

```
`main.js`と同様にBGMと効果音の再生コードを追加して。GameAudioクラスは外部から与えるので実装する必要はない
```

[GameAudio クラス][./docs/utils/game-audio.js]は、音声を再生するためのユーティリティークラスである。`index.html`ファイル内からこのファイルを読み込んで利用する。

## プラットフォームの動作原理

### 全体アーキテクチャ

このプラットフォームは、以下のコンポーネントから構成されている：

1. **対話型 AI（Claude）**: `prompt.md`に従い、ユーザー入力の解釈、ゲームアイデアの生成、コード実装、フィードバック対応を担当
2. **設計ガイドデータ**: `game-design-guide.md`に含まれるワンボタンゲーム設計の原則と分類体系
3. **テスト評価エンジン**: `one-button-game-test-framework.js`, `repl-game-testing-prompt.md`を使用したゲーム評価システム
4. **p5.js 実装環境**: `p5js-game-template.html`をベースとしたゲーム実装環境

情報の流れは以下のように進行する：

1. ユーザー入力（テーマ）→ 設計ガイドを参照したアイデア生成 → 複数のゲームコンセプト
2. ゲームコンセプト → テスト評価エンジン → 数値評価結果
3. 選択されたコンセプト → p5.js 実装コード生成 → プレイ可能なゲーム
4. ユーザーフィードバック → コード最適化 → 改良されたゲーム

### アイデア生成メカニズム

プラットフォームのアイデア生成は以下のプロセスで行われる：

1. **テーマ分析**: ユーザー指定のテーマからコア要素を抽出
2. **多様性確保**: 以下の次元で異なるアイデアを生成
   - ボタン相互作用（押す、長押し、リリース）
   - 物理原則（重力、運動量、弾性）
   - ゲーム環境（空間制約と特性）
   - 動作パターン（直線、軌道、振動）
   - プレイヤー目標（収集、回避、整列）
3. **ランダム要素統合**: 視覚表現、時間操作、空間関係などの要素を組み合わせ
4. **設計ガイド参照**: `game-design-guide.md`の各セクションを参照し、設計原則に準拠

各ゲームコンセプトは、コアメカニック、プレイヤー目標、チャレンジ要素、スコアリングシステム、ワンボタンパターン、独自の魅力、リスクリワード動的要素の 7 つの側面から定義される。

### 自動評価システムの仕組み

評価システムは`one-button-game-test-framework.js`に実装され、以下の要素で構成されている：

1. **GameSimulator**: ゲーム環境をシミュレートするコアエンジン

   - 物理演算、衝突検出、オブジェクト管理機能を提供
   - 内部的に 60fps 相当のゲームロジックを実行

2. **InputPatternGenerator**: 異なるプレイヤータイプをシミュレート

   - 初心者パターン: 遅い反応、不規則なタイミング、頻繁なミス
   - 熟練者パターン: 最適なタイミング、最小限のミス、一貫した操作
   - 単調パターン: ボタン連打、常時押し続けなどの簡単な入力

3. **GameAnalyzer**: 下記の評価結果を合計（最大 12 点）してゲームをテスト
   - ゲーム持続時間（0-3 点）
   - スキルギャップ（0-3 点）
   - 難易度進行（0-3 点）
   - 単調入力耐性（0-3 点）

### コード生成と実装プロセス

選択されたゲームコンセプトの実装は以下のステップで行われる：

1. **テンプレート解析**: `p5js-game-template.html`の構造を解析

   - 入力処理システム
   - オブジェクトプール管理
   - 衝突検出ユーティリティ
   - コアゲームループ構造

2. **ゲームオブジェクト定義**:

   - プレイヤー、障害物、収集物などの基本オブジェクト
   - 物理特性と視覚的表現の定義
   - 初期化関数と更新ロジックの実装

3. **コアメカニズム実装**:

   - ワンボタン制御メカニズムの実装
   - 物理システムと衝突システムの統合
   - スコアトラッキングと表示機能
   - 難易度進行システム

4. **最適化処理**:
   - コードサイズの最適化（777 行以内に制限）
   - 不要な空白行の削除
   - 視覚効果の簡略化（必要に応じて）
